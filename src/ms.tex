%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Please read the CONTRIBUTING.md file in this repository for notes about
%   style and latex conventions!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[modern]{aastex631}
\usepackage{xspace}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{ulem}

% To allow putting figures in a subdir
\graphicspath{{figures/}}

\submitjournal{ApJ}

\shorttitle{Astropy Project III}
\shortauthors{The Astropy Collaboration}

\input{preamble.tex}

% Links to documentation: subpackages
\newcommand{\astropysubpkg}[1]{\href{http://docs.astropy.org/en/stable/#1/index.html}{\texttt{astropy.#1}}\xspace}
\newcommand{\astropyiosubpkg}[1]{\href{http://docs.astropy.org/en/stable/io/#1/index.html}{\texttt{astropy.io.#1}}\xspace}
\newcommand{\astropywcsaxes}{\href{http://docs.astropy.org/en/stable/visualization/wcsaxes/index.html}{\texttt{astropy.visualization.wcsaxes}}\xspace}
\newcommand{\astropycosmology}{\astropysubpkg{cosmology}}
\newcommand{\astropycosmologyunits}{\href{https://docs.astropy.org/en/stable/cosmology/units.html}{\texttt{astropy.cosmology.units}}}
\newcommand{\astropyunits}{\astropysubpkg{units}}
\newcommand{\astropycoordinates}{\astropysubpkg{coordinates}}
\newcommand{\astropyconstants}{\astropysubpkg{constants}}
\newcommand{\astropytime}{\astropysubpkg{time}}
\newcommand{\astropymodeling}{\astropysubpkg{modeling}}

% Links to documentation: classes
\newcommand{\astropyapi}[2]{\href{https://docs.astropy.org/en/stable/api/astropy.#1.html}{#2}}
\newcommand{\astropyapidoc}[2]{\astropyapi{#1}{\texttt{#2}\xspace}}

\newcommand{\astropySpectralCoord}{\astropyapidoc{coordinates.SpectralCoord}{SpectralCoord}}
\newcommand{\astropySkyCoord}{\astropyapidoc{coordinates.SkyCoord}{SkyCoord}}
\newcommand{\astropyICRS}{\astropyapidoc{coordinates.builtin_frames.ICRS}{ICRS}}
\newcommand{\astropyGalacticLSR}{\astropyapidoc{coordinates.builtin_frames.
GalacticLSR}{GalacticLSR}}
\newcommand{\astropyAltAz}{\astropyapidoc{coordinates.builtin_frames.AltAz}{AltAz}}
\newcommand{\astropyGalactocentric}{\astropyapidoc{coordinates.builtin_frames.Galactocentric}{Galactocentric}}
\newcommand{\astropyCosmology}{\astropyapidoc{cosmology.Cosmology}{Cosmology}}
\newcommand{\astropyFlatLambdaCDM}{\astropyapidoc{cosmology.FlatLambdaCDM}{FlatLambdaCDM}}
\newcommand{\astropyTable}{\astropyapidoc{table.Table}{Table}}
\newcommand{\astropyQTable}{\astropyapidoc{table.QTable}{QTable}}
\newcommand{\astropyTime}{\astropyapidoc{time.Time}{Time}}
\newcommand{\astropyLeapSeconds}{\astropyapidoc{time.LeapSeconds}{LeapSeconds}}
\newcommand{\astropyDistribution}{\astropyapidoc{uncertainty.Distribution}{Distribution}}
\newcommand{\astropyUnit}{\astropyapidoc{units.Unit}{Unit}}
\newcommand{\astropyQuantity}{\astropyapidoc{units.Quantity}{Quantity}}
\newcommand{\astropyScienceState}{\astropyapidoc{utils.state.ScienceState}{ScienceState}}

% suggestion: shortcut reference to Paper II
\newcommand{\paperii}{\cite{astropy:2018}}

% Maybe have command link to Zenodo reference instead, or include it?
\newcommand{\astropyAPE}[1]{\href{https://github.com/astropy/astropy-APEs/blob/main/APE#1.rst}{APE #1}\xspace}

\newcommand{\secauthor}[1]{{\color{blue}Author:~\textit{#1}}}
\newcommand{\secunfilled}{{\color{red}Author:~\textit{Looking for volunteers!}}}

\defcitealias{astropy:2013}{Paper I}
\defcitealias{astropy:2018}{Paper II}


\begin{document}

\draft{\today}

\title{The Astropy Project: \\
       Sustaining and Growing a Community-oriented Open-source Project and
       the Latest Major Release (v5.0) of the Core Package}

\correspondingauthor{Astropy Coordination Committee}
\email{coordinators@astropy.org}

\author{Astropy Collaboration}
\noaffiliation
{\let\thefootnote\relax\footnote{{The author list has two parts: the authors that made significant contributions to the writing of the paper in order of contribution, followed by contributors to the \astropy Project in alphabetical order. \textbf{The position in the author list does not correspond to contributions to the \astropy Project as a whole.} A more complete list of contributors to the core package can be found in the \href{https://github.com/astropy/astropy/graphs/contributors}{package repository}, and at the \href{http://www.astropy.org/team.html}{\astropy team webpage}.}}}

% \input{author.tex}

\begin{abstract}
The \astropy Project supports and fosters the development of open-source and openly-developed
\python packages that provide commonly-needed functionality to the astronomical
community.
A key element of the \astropy Project is the core package \astropypkg, which serves as the
foundation for more specialized projects and packages.
In this article, we summarize key features in the core package as of the recent major
release, version 5.0, and provide major updates for the project.
We then discuss supporting a broader ecosystem of inter-operable packages,
including connections with several astronomical observatories and missions.
We also revisit the future outlook of the \astropy Project and the current
status of Learn Astropy.
We conclude by raising and discussing the current and future challenges facing the project.
\end{abstract}

\keywords{%
    Astrophysics - Instrumentation and Methods for Astrophysics
    ---
    methods: data analysis
    ---
    methods: miscellaneous
}


\section{Introduction} \label{sec:intro}

\secauthor{Adrian Price-Whelan}

The \python programming language is a high-level, interpreted (as opposed to
compiled) programming language that has become an industry standard across many
computational domains, technological sectors, and fields of research.
Despite claims to the contrary \citep{Portegies-Zwart:2020}, \python enables
scalable, time- and energy-efficient code execution \citep[e.g.,][]{Augier:2021}
with a focus on code readability, ease of use, and interoperability with other
languages.
Over the last decade, \python has grown enormously in popularity to become a
dominant programming language in the astronomical and broader scientific
communities.
For example, Figure~\ref{fig:python-mentions} shows the number of yearly
full-text mentions of \python as compared to a few other programming languages
in refereed articles in the astronomical literature, demonstrating its nearly
exponential growth in popularity.
The rapid adoption of \python by astronomy researchers, students, observatories,
and technical staff combined with an associated increase in awareness and
interest about open-source software tools is contributing to a paradigm shift in
the way research is done, data is analyzed, and results are shared in astronomy
and beyond.

One of the factors that has led to its rapid ascent in popularity in scientific
contexts has been the significant, volunteer-driven effort behind developing
community-oriented open-source software tools and fostering communities of users
and developers that have grown around these efforts.
Today, a broad and feature-diverse ``ecosystem'' of packages exists in the
\python scientific computing landscape: Roughly ordered from general-use to
domain-specific, this landscape now includes packages that provide core
numerical analysis functionality like \package{numpy} \citep{numpy:nature} and
\package{scipy} \citep{scipy}, visualization frameworks like
\package{matplotlib} \citep{matplotlib}, machine learning and data analysis
packages like \package{tensorflow} \citep{tensorflow}, \package{pymc3}
\citep{Salvatier:2016}, and \package{emcee} \citep{emcee}, domain-specific
libraries like \package{yt} \citep{yt:2011}, \package{plasmapy}
\citep{plasmapy}, \package{sunpy} \citep{sunpy:apj}, \package{Biopython}
\citep{biopython}, and \package{sympy} \citep{sympy} (to name a few in each
category).
The \astropypkg \citep{astropy:2013, astropy:2018} core package began in this
vein, as an effort to consolidate the development of commonly-used functionality
needed to perform astronomical research into a community-developed \python
package.

The \astropypkg core package was one of the first large, open-source \python
packages developed for astronomy and provides, among other things, software
functionality for reading and writing astronomy-specific data formats (e.g.,
FITS), transforming and representing astronomical coordinates, and representing
and propagating physical units in code.
An early description of the core functionality in \astropypkg can be found in
the first Astropy paper \citep{astropy:2013} or in detail in the core package
documentation.\footnote{\url{https://docs.astropy.org/}}
The \astropypkg core package is now largely stable in that the software
interface does not change without sufficient and significant motivation, and the
addition of new features into the core package has slowed significantly as
compared to the first years of its development.
This is largely driven by the fact that the core package now represents just one
piece of the broader astronomy \python context, and much new feature development
is now happening in more specialized packages that are expanding the
capabilities of the Astropy ecosystem by building on top of the foundations laid
by the \astropypkg core package.
Because of this natural expansion, the name Astropy has grown in scope beyond a
single \python library to become ``the Astropy Project.''

The Astropy Project is a community effort that represents the union of the
\astropypkg core package, the ecosystem of astronomy-specific software tools
that are interoperable with \astropypkg (Astropy Affiliated Packages),
\emph{and} the community of users, developers, and maintainers that participate
in Astropy efforts.
However, there is no institution responsible for managing the Astropy Project,
for funding or maintaining its development, or sustaining it into the future:
The Project is maintained and coordinated largely by volunteers.
While new Astropy-affiliated packages are being developed that expand upon the
core functionality in the \astropypkg package, representing a natural expansion
of the Astropy Project ecosystem, the needs of and challenges faced by the
Project are evolving.
In particular, the transition from focusing our energy on development and
maintenance of a single core package, to instead sustaining the core package and
fostering the development of the community and its expansion has been a key
issue faced by the Astropy Project in the last several years.

In this Article, we briefly describe recent key updates in the \astropypkg core
package since the last Astropy paper (``Paper II''; \citealt{astropy:2018}),
major updates in the governance, contributor base, and funding of the Project,
and discuss some of the future plans and challenges faced by the Astropy
Project.


\begin{figure}
    \begin{centering}
      % \includegraphics[width=\textwidth]{figures/python-mentions.pdf}
        \caption{
            Yearly full-text mentions of programming languages (indicated in the
            figure legend) in refereed publications in the astronomical
            literature database in the Astrophysics Data System (ADS;
            \citealt{ads}).
            \python has rapidly become the dominant programming language
            mentioned in refereed articles over the last 10 years.
        }
        \label{fig:python-mentions}
    \end{centering}
\end{figure}


\section{Major Updates to the Astropy Core Package} \label{sec:core-updates}

\subsection{New Long-term Support (LTS) Version: v5.0} \label{sec:core-v50}

\secauthor{Tom Robitaille}

Major versions of the core package -- that is to say versions which add and/or
modify functionality -- are released approximately every six months, and are
then maintained with releases that fix issues, until the next major version
is released. However, every two years a major release is designated as a
long-term support (LTS) release which continues to be maintained for up to two
years \citep{ape2}. The motivation for LTS releases is to provide longer-term stable
versions of astropy that users requiring a high level of stability can make
use of if they do not always need the latest features (this could include
for example telescope pipelines and so on). The 5.0 release of the core package was designated as LTS,
and since it was released at the end of 2021, it will be maintained until the
end of 2023.


\subsection{Highlighted Feature Development} \label{sec:core-features}

  \secauthor{Nathaniel Starkman, Marten van Kerkwijk}

  The \astropypkg core package is mature and stable, in that many features have
  been part of the core package for years with (purposefully) few changes to the
  software interface. This maturity and stability allows for the broader
  astronomy \python community to rely upon the \astropypkg core package and
  build specialized packages within the Astropy ecosystem. Even many
  non-astronomical \python libraries have come to rely on \astropypkg.

  The relationship between \astropy and community is reciprocal, with the
  growing and evolving needs of the community and the maturation of the broader
  scientific \python ecosystem now driving the development of the \astropypkg
  core package.

  One manifestation of this development realizing some features do not actually
  belong in the core package, either because they are of more general use
  outside of \astropypkg, or because they are too specialized. An example of the
  former is the copy of the IAU Standards Of Fundamental Astronomy (SOFA)
  software Collection\footnote{\url{http://www.iausofa.org}} \citep{sofa} that
  \astropy carried, as well as the \python wrappers for it.  Since this is more
  basic infrastructure, with a release cycle set by SOFA, it made more sense to
  create separate packages that \astropypkg can depend on: \package{ERFA}
  \citep{erfa} and \package{PyERFA} \citep{pyerfa}. An example of something that
  was too specialized was a Virtual Observatory sub-package (now removed).  Of
  its content, the Simple Application Message Protocol made sense to keep
  (\astropysubpkg{samp}), but other parts belonged more properly in {\tt
  Astroquery} (see Sect.~\ref{sec:astroquery}).

  Within \astropypkg, development may be roughly split into a few categories:
  new features added, performance enhancements, intra and inter-package
  interoperability, and improvements to precision, accuracy, and
  reproducibility. We discuss these in turn.


\subsubsection*{New and Planned Features} \label{sec:core-features-new}

% \begin{itemize}
%  \item Time Series sub-package (V3.1: New Box Least Squares Periodogram)
%  \item Uncertainties and Distributions
%   \item ERFA module is now it’s own thing; Obliquely tie in that units
%    remains in astropy -> above
%  \item ? Pytest plugin ecosystem -> done elsewhere
%  \item A new SpectralCoord class for representing and transforming spectral quantities
%    Velocity in Coordinates
%  \item WCS API : A shared Python interface for World Coordinate Systems
%        Include APE 14 reference
% \end{itemize}

New features come in various forms, from new submodules providing
wholly new capabilities, to larger additions to existing submodules,
to large rewrites of the interface of modules.  This range is spanned
by the five main new features that entered the astropy core since the
previous summary \citepalias{astropy:2018}.

New features present a particular difficulty for a mature package such
as \astropypkg, because by their nature they have not been tried out
much and it is difficult to know in advance what the best interface
will be, and hard to address all possible use cases in one go, even
within \astropypkg\ itself.  To give a sense of this, we include in
our descriptions how we hope the new features will evolve (realizing
that, in the end, in a user-driven project like \astropy, what happens
depends mostly on what is highest on the priority list of those that
have time to contribute).

\paragraph{Uncertainties and Distributions.} Early in our carreers, we
were likely all taught that a measurement without a unit or an
uncertainty is essentially meaningless.  \astropyunits already
provides the ability to associate numbers with units, and propagate
these correctly, with its \astropyQuantity\ class, but so far the
ability to associate and propagate uncertainties is relatively
limited: in \astropysubpkg{nddata}, there are options to associate
errors with data arrays, but these are treated as independent, i.e.,
covariances are not tracked.

In general, proper error propagation is difficult, and often it is
best to use Monte Carle methods.  With the new
\astropysubpkg{uncertainties} sub-package, a first step is made to
make this possible.  It allows one to generate, for each variable,
randomly drawn samples in a \astropyDistribution, and then propagate
these by passing them through the normal analysis, producing a
\astropyDistribution\ of final results that can be inspected.

This \astropyDistribution\ can be any type of array, including of
course a \astropyQuantity, and the goal is to ensure it can be
seamlessly used to instantiate also other astropy classes, such as
\astropySkyCoord\ and \astropyTime.

Apart from Monte-Carlo error propagation, the plan for
\astropysubpkg{uncertainties} is to also support the case where values
have associated uncertainties, and these are propagated assuming that
they are normally distributed, but tracking covariances.  One
implementation problem to be solved is when to {\em stop} tracking
covariances.  For instance, a simple operation such as subtracting the
mean from $N$ data points implies that all data points are now
covariant with each other, i.e., one has to carry $N\times N$
covariances.  For a large image, that becomes not just pointless but
also prohibitive in terms of memory and CPU usage.

\paragraph{Time series.}  From sampling a continuous variable at fixed
times to counting events binned into time windows, many different
areas of astrophysics require the manipulation of time series.  These
are often logically tables, and the new \astropysubpkg{timeseries}
sub-package extends the \astropyQTable\ class to tables of data as a
function of time, where the data can either represent samples or
averages over particular time bins.  The new classes offer a number of
special methods to manipulate time series (folding, resampling, etc.)
and to read different data formats (such as {\em Kepler} lightcurves,
etc.).

Also part of \astropysubpkg{timeseries} are common analysis routines,
including Lomb-Scargle and box-least-squares periodogrammes.

\paragraph{Spectral Coordinates.} Measurements are often taken at
specific ``spectral coordinates'', be they frequencies, wavelengths,
or photon energies.  The new \astropySpectralCoord\ class allows to
transform between these as well as to equivalent Doppler velocities.
It builds on the \astropyQuantity, which can also represent these
kinds of physical quantities, and allows conversion via dedicated
equivalencies, but aims to make this more straightforward.
Furthermore, it can be made aware of the observer and target reference
frames, allowing for instance transformation from telescope-centric (or
topocentric) frames to Barycentric or Local Standard of Rest
(LSRK and LSRD) velocity frames.

\paragraph{A High-Level Interface to World Coordinate Systems.}
Astronomical data are often provided with information about the
``real-world'' coordinates that correspond to pixel coordinates. This
mapping is the essence of the ``World Coordinate System (WCS)''
concept.  From its inception, the \astropysubpkg{wcs} sub-package
allowed access to WCS information provided in, e.g., FITS files, but
it became clear that other WCS standards and representations had to be
supported for new missions and observatories (e.g., the James Webb
Space Telescope and the Rubin Observatory).  To harmonize these, a new
high-level interface was created, based on a formal design first
proposed via an \astropy\ Proposal for Enhancement (\astropyAPE{14}).
The hope is that by having a formal design, it will be straightforward
for other packages implementing WCS objects to either modify their
classes to conform to the new interface or build thin wrappers that
conform to it.  The implementation in \astropysubpkg{wcs} interacts
well with other \astropypkg\ objects such as \astropySkyCoord\ and
\astropyTime.

\subsubsection*{Interoperability} \label{sec:core-features-interoperability}

\subsection*{Precision, Accuracy, \& Reproducibility} \label{sec:core-features-precision_accuracy_repreducibility}


\subsection*{Precision, Accuracy, \& Reproducibility} \label{sec:core-features-performance}


\subsection*{Precision, Accuracy, \& Reproducibility} \label{sec:core-features-future}


\subsection*{Precision, Accuracy, and Reproducibility} \label{sec:core-features-precision_accuracy_repreducibility}

  An important focus of \astropy has been to increase the precision and accuracy
  of its functionality, while, where appropriate, making sure results obtained
  using older versions of \astropypkg are reproducible.
  % Something about ScienceState
  Notable improvements have been made to \astropytime, \astropyconstants,
  \astropycoordinates, and \astropycosmology.

  \paragraph{Time}

    In astronomy, time accuracy down to the second is frequently important.
    Whether for planning observations or crunching data, missing seconds can
    meaningfully impact results. Before, when using \astropyTime in \astropytime
    leap seconds had to be manually applied; now leap seconds are applied
    automatically. Moreover, \astropypkg updates internal time data-files to
    ensure that the correct leap second adjustment is always used. For
    reproducibility, e.g. with an old code, \astropyLeapSeconds may also be
    manually applied.

  \paragraph{Constants}

    Measurements of physical constants (and the units defined from them) improve
    over time. Periodically the standardized systems of units and constants are
    updated to reflect these improvements, for instance in 2019 the SI system was
    redefined \citep{NIST2019}, with an accompanying update to the physical
    constants in
    \href{https://codata.org/initiatives/data-science-and-stewardship/fundamental-physical-constants/}{\texttt{SI/CODATA
    2018}}. \astropypkg contains two modules -- \astropyconstants and
    \astropyunits -- for working with constants and units, respectively.
    \astropyconstants now defaults to use the \texttt{SI/CODATA 2018} values, with
    the relation between units in \astropyunits based upon these constants. Most
    of \astropypkg and affiliate packages build upon \astropyunits, so this update
    has far-reaching effects across the \astropy ecosystem and astronomy
    community.

    For reproducibility, \astropypkg allows the constants (and therefore units)
    definitions to be rolled back to prior values, for instance the
    \texttt{SI/CODATA 2014} definitions.
    % CITATION
    The constants and units definitions are set by configuration file as well as
    \astropyScienceState (an runtime configuration controller). For work where
    updates to the values of the fundamental constants significantly alters
    results we recommend including with the work an astropy configuration file,
    which specifies the set of constants used.

  \paragraph{Cosmology}
    % TODO! At least one good sentence about "what is the benefit of astropy.cosmology"

    \astropycosmology contains classes for representing cosmological models.
    % currently all homogeneous and isotropic variations of the
    % Friedmann-Lemaitre-Robertson-Walker metric.
    Bundled with the classes are commonly used \astropyCosmology realizations, for
    example best-fit measurements from
    \href{https://lambda.gsfc.nasa.gov/product/map/current/}{WMAP}
    \citep{WMAP2003} and \href{https://www.nasa.gov/mission_pages/planck}{Planck}
    \citep{PlanckMission:2006}.

    When these important missions publish new measurements, \astropycosmology is
    updated to include these results as realizations of the appropriate class
    (generally \astropyFlatLambdaCDM). The models used by WMAP and Planck do not
    always exactly correspond to \astropycosmology classes, for instance the
    Planck 2018 results \citep{Planck2018VI} include massive neutrinos in
    $\Omega_{matter,0}$, while in \astropyFlatLambdaCDM this mass contribution is
    stored in a separate parameter. Consequently, while some parameter values
    appear different from the source paper, the \astropyCosmology realizations
    correctly reproduce the cosmological models.

    Since \citealt{astropy:2018} the following cosmology realizations have been
    added:
    \href{http://docs.astropy.org/en/stable/api/astropy.cosmology.WMAP1.html}{\texttt{WMAP1}}
    from WMAP First Year \citep[Table 7: WMAP + CBI + ACBAR + 2dFGRS +
    Lya]{WMAP1Year:2003};
    \href{http://docs.astropy.org/en/stable/api/astropy.cosmology.WMAP3.html}{\texttt{WMAP3}}
    from WMAP Three Year \citep[Table 6: WMAP + SNGold]{WMAP3Year:2007};
    \href{http://docs.astropy.org/en/stable/api/astropy.cosmology.Planck15.html}{\texttt{Planck15}}
    from Planck 2015 \citep[Table 4: TT, TE, EE + lowP + lensing +
    ext]{Planck2015XIII:2016};
    \href{http://docs.astropy.org/en/stable/api/astropy.cosmology.Planck18.html}{\texttt{Planck18}}
    from the Planck 2018 best-fit cosmological parameters \citep[Table 2: TT, TE,
    EE + lowE + lensing + BAO]{Planck2018VI:2020}.

    Astropy provides a
    \href{http://docs.astropy.org/en/stable/api/astropy.cosmology.default_cosmology.html}{configurable
    default cosmology}. All calculations done in a cosmological context will use
    this default cosmology. The default \astropyCosmology has been updated to the
    Planck 2018 parameters. For reproducibility, the default cosmology may be set
    to old defaults, such as the WMAP Three Year values. The default cosmology is
    dynamically configurable using \astropyScienceState, meaning a set of
    calculations may be run using different assumed cosmologies, and results
    compared between the two.
    % Repeat the word default less.

  \paragraph{Coordinates}

    Being able to describe the position of objects, i.e. their coordinates, is
    fundamental across many knowledge domains. \astropypkg provides
    \astropycoordinates for working with low-level positional and velocity data
    all the way to high-level coordinate objects with reference frames,
    atmospheric information, and more. A central feature of \astropycoordinates is
    the ability to transform data between reference frames, e.g. \astropyICRS
    \citep{ICRS:1997} to \astropyGalacticLSR \citep{GalacticLSR:2010}. However,
    there have been some historical limitations for spatially proximate
    transformations, impacting the usefulness of \astropycoordinates for
    ground-based telescopes and intra-solar astronomy. Transformations in the
    \astropyAltAz frame were reasonably precise for very distant objects, but
    wrong by up around several arcseconds for e.g. the location of the moon. Now
    these transformations are much more precise, down to the milli-arcsecond
    level. Similar precision improvements were made to the
    \astropyapi{coordinates.builtin_frames.HADec}{Hour Angle-Declination} frame
    transformations. Additionally,
    \astropyapi{coordinates.builtin_frames.BaseEclipticFrame}{Ecliptic frames}
    and associated transformations have been updated to correctly reflect the
    “true” (includes precession but not nutation) and “mean” (precession and
    nutation) terminology.

    For Galactic astronomers, the \astropyGalactocentric
    \astropyapi{coordinates.galactocentric_frame_defaults}{frame defaults} have
    been updated to include more recent measurements (tabulated in the
    \href{https://docs.astropy.org/en/stable/api/astropy.coordinates.galactocentric_frame_defaults.html#astropy.coordinates.galactocentric_frame_defaults.references}{\texttt{frame\_defaults.references}}
    attribute). For reproducibility, old definitions are still available, and will
    continue to be so as \astropypkg is updated with forthcoming measurements of
    the Galactic center, solar motion, etc.
    % may be used by setting the default value to ``pre-v4.0'' in the
    % \href{https://docs.astropy.org/en/stable/api/astropy.coordinates.galactocentric_frame_defaults.html}{\texttt{galactocentric\_frame\_defaults}}
    % \astropyScienceState.



\section{Major Updates in the Astropy Project} \label{sec:project-updates}

\subsection{Project governance} \label{sec:project-governance}

\secauthor{Erik Tollerud}

%Briefly summarize new procedures and governance structure, new CoCo, election
%process overview, etc.

As part of the process of developing Astropy into a long-term sustainable
product, and to improve transparency and accountability, the Project agreed to
write down and formalize our governance structure (partly supported by explicit
funding for this purpose - see \S \ref{sec:project-funding}). At the 2019
Astropy Coordination Meeting, input was gathered from participants on what governance
structures existed in the associated Open Source Software communities, and what
would fit well with the needs of Astropy. This led into a ``retreat'' planned
for March 2020, but due to the COVID-19 pandemic, this became a series of
virtual meetings of the ``Astropy Governance Working Group''.  This group
drafted the APE 0 document \citep{ape0}, which was then eventually ratified and
implemented by the ``Astropy Governance Implementation Working Group'' in Fall
2021. While the process emphasized flexibility and the ability to adapt to
changing circumstances, it is expected that this is the framework Astropy's
governance will operate in for at least the medium-term future.

The APE0 \citep{ape0} document lays out the principles of this governance
structure, so we refer the reader to that document for a more thorough
description.  However here we highlight some key elements. While many of these
principles were already de facto true or have been discussed organically (and
have been discussed in earlier papers in this series), the APE0-based governance
aimed to provide a single place where the community can agree as a starting
point. With this in mind, it highlights the developer and user community of the
Astropy Project as the ultimate sources of authority, as well as the core
principle of ``do-ocracy'' that those who do work for the Project (be it coding,
training, or other less concrete contributions) gain more influence on the
outputs of the Project by virtue of their effort.  APE0 adds, however, the
concept of ``voting members'' - a self-governed part of that community who are
entrusted to elect the Coordination Committee. While this committee has existed
from the inception of the project, APE0 establishes a formal voting process for
this committee, and explicitly outlines the rights and responsibilities of the
Coordination Committee. This role is mainly to facilitate consensus and act as
the decision maker when other mechanisms have failed.  However, it also includes
powers that either require central authority or secrets (e.g., passwords), but
APE0 also charges the Committee to devolve responsibilities and seek community
input on these items as often as possible.

The first Coordination Committee election under these rules took place in Fall
2021, electing a mix of prior existing and new coordination committee members,
and was contested in the sense of more candidates than available slots. This
suggests the process is already working to serve the long-term interests of the
committee to both spread the coordination effort, and to ensure it is not
dominated by the same people for as long as the Project continues. While other,
more fine-grained governance improvements are planned for the future, it is
clear the foundation is now in place.


\subsection{Contributor base} \label{sec:project-contributors}

\secauthor{Adrian Price-Whelan}

Overview and statistics of contributors. Highlight changes since v2.0.

\begin{figure}
    \begin{centering}
      % \includegraphics{figures/contributor-summary.pdf}
        \caption{Placeholder figure!}
        \label{fig:contributor-summary}
    \end{centering}
\end{figure}

% Transition of needs: From new features, to community development, sustainability, ...
% - pipeline between User, Participant, Code contributor, Maintainer, Coordinator.

\subsection{Inclusion, Diversity, and Equity Programs} \label{sec:project-ide}

\secauthor{Lía Corrales}

With support from the Moore Foundation, the \astropy Project was
allocated funding to support mentoring programs. In 2020 a call was
made to submit proposals for IDE (Inclusion, Diversity, and
Empowerment) initiatives for project-wide consideration on
Github. This process was deemed the most ``open'' because it allowed
for community wide feedback to focus and improve proposal
initiatives. Two programs were selected via this process, described
below.

\textbf{Outreachy:} \todo{No author assigned}{Describe the outreachy project}

\textbf{Women of Color Code (WoCCode)} is a peer-mentoring network for
coders from traditionally marginalized groups, most notably women of
color. Participants were invited to the WoCCode Slack space and
encouraged to attend monthly webinars to share skills in the context
of open source software libraries. Every other month, a guest speaker
was invited to talk about their career path and share a skill. Program
participants were solicited in the fall of 2020, yielding 73
applications from 17 countries (48\% from the United States, 37\% from
Africa, and 15\% from remaining continents). We selected participants
who we identified as having a high potential for contributing to open
source projects: intermediate to advanced programming skills with a
vocal interest in contributing. Of the thirty applicants invited to
the program, nineteen joined the community on Slack. Participants were
organized into cohorts based on interest and each cohort was assigned
one of three mentors that were also selected via open
application. Mentors acted as a general resource to participants, gave
one webinar, and organized a hack day. WoCCode also supported
registration of two participants to attend the American Astronomical
Society virtual summer 2021 meeting.

Participants rated the impact of the program as very high. In the
final webinar, participants reported a change in their perception of
coding in general, for example, accepting coding as something they can
do for fun. Participants reported generally feeling comfortable asking
questions and interacting with a community where ``[e]veryone's
thoughts are welcomed, no one is made to feel less important'' and
where one can enjoy ``warm interactions with likeminded people.''
WoCCode is continuing into 2022 by broadening participation in the
Slack space and publicly advertising the guest webinar events.

In addition to the supported mentoring initiatives, the \astropy
project as a whole has taken steps to examine representation of
marginalized groups within the project and search for avenues of
improvement.

% Much of this text was adapted from Robel Geda's report from NSBP and
% SACNAS. Please include him on the author list.
\textbf{\astropy representation at national diversity conferences:}
Several members of the \astropy community attended virtual conferences
of the National Society of Black Physicists (NSBP) and SACNAS
(focusing on Hispanic and Native American scientists across all STEM
fields). \astropy representatives noted that one underlying topic came
up multiple times. A major barrier for persons who come from
underrepresented communities is the lack of resources and expertise
that are necessary to train students. Writing PEP 8 compliant software
and understanding the Git and Github workflow is not part of the
standard Physics and Astrophysics curriculum. Additionally, the larger
Astronomnical community is still in the process of transitioning
towards Python based tools, making it difficult for students not
currently under advisement by some one with extensive Python expertise
to get involved with the open source Python community. Projects such
as Learn Astropy could have a profound impact by empowering
underrepresented groups because it provides a free, searchable, and
accessible introduction to Python tools for astrophysical
research. Representatives also noted that offering training and
teaching materials to PIs of Research Experience for Undergraduate
(REU) programs throughout the United States could be helpful for
encouraging advisors to teach students how to use Astropy, create
their own libraries, and use version control on open source platforms
like Github. Such materials could also be offered as a workshop at
national diversity conferences themselves, as SACNAS solicits special
session proposals each year.

\textbf{NumFOCUS ``Contributor Diversification \& Retention'' (CDR)
  initiative:} \todo{No author assigned}{Describe more about this.}


\subsection{Funding} \label{sec:project-funding}

\secauthor{Aarya Patil}

Summarize funding sources (Moore, NASA) and amounts and what this has been used
for.


\section{Supporting the Ecosystem of Astronomical Python Software}
\label{sec:ecosystem}

\subsection{Community-oriented infrastructure}

\secauthor{Nicholas Earl}

The Astropy project supports the broader ecosystem by providing pre-configured
infrastructure packages that the community can use to support and maintain
their own software package infrastructure. These include tools to easily
generate documentation and setup automated testing, as well as provide
package scaffolding for new projects.

Sphinx is a common and useful tool for generating documentation for Python
packages. The Astropy project maintains a default Sphinx configuration along
with Astropy-specific extensions which can be easily added to community
projects via the
\href{https://github.com/astropy/sphinx-astropy}{\texttt{sphinx-astropy}} meta
package. This tool provides a pre-configured Sphinx setup compatible with
Astropy projects, which includes several extensions useful for generating API
documentation
(\href{https://github.com/astropy/sphinx-automodapi}{\texttt{sphinx-automodapi}}),
allowing for Numpy docstring parsing
(\href{https://github.com/numpy/numpydoc}{\texttt{numpydoc}}), embedded image
handling
(\href{https://github.com/sphinx-gallery/sphinx-gallery}{\texttt{sphinx-gallery}};
\href{https://github.com/python-pillow}{\texttt{pillow}}), advanced
documentation testing support
(\href{https://github.com/astropy/pytest-doctestplus}{\texttt{pytest-doctestplus}}),
and providing a custom documentation theme ideal for analysis packages
(\href{https://github.com/astropy/sphinx-astropy}{\texttt{astropy-sphinx-theme}}).

Community package testing infrastructure is supported through the
\href{https://github.com/astropy/pytest-astropy}{\texttt{pytest-astropy}}
meta-package, providing a unified testing framework with useful extensions
compatible with both Astropy- and non-Astropy-affiliated community packages.
This meta-package pulls in several
\href{https://github.com/pytest-dev/pytest}{\texttt{pytest}} plugins to help
with custom test headers
(\href{https://github.com/astropy/pytest-astropy-header}{\texttt{pytest-astropy-header}}),
accessing remotely-hosted data files in tests
(\href{https://github.com/astropy/pytest-remotedata}{\texttt{pytest-remotedata}}),
interoperability with documentation
(\href{https://github.com/astropy/pytest-doctestplus}{\texttt{pytest-doctestplus}}),
dangling file handle checking
(\href{https://github.com/astropy/pytest-openfiles}{\texttt{pytest-openfiles}}),
data array comparison support in tests
(\href{https://github.com/astropy/pytest-arraydiff}{\texttt{pytest-arraydiff}}),
sub-package command-line testing support
(\href{https://github.com/astropy/pytest-filter-subpackage}{\texttt{pytest-filter-subpackage}}),
improved mock object testing
(\href{https://github.com/pytest-dev/pytest-mock}{\texttt{pytest-mock}}), test
coverage reports and measurements
(\href{https://github.com/pytest-dev/pytest-cov}{\texttt{pytest-cov}}), and
configuring package for property-based testing
(\href{https://github.com/HypothesisWorks/hypothesis}{\texttt{hypothesis}}).

The Astropy Package Template helps facilitate the setup and creation of new
Python packages leveraging the Astropy ecosystem. This tool utilizes the
Cookiecutter project to walk users through the process of creating new
packages complete with documentation and testing support. Additionally, the
package template generation process includes the ability to setup
interoperability with GitHub, allowing for easy repository access from
documentation, as well as an example GitHub Actions workflow to demonstrate
the use of GitHub's continuous integration tooling.

\subsection{Affiliated packages}

\secauthor{Matt Craig, Brett Morris}

Highlight a few new affiliated packages and major updates to existing ones.
Include a big table of all affiliated packages and references (as in v2.0
paper).

\subsection{Connections with data archives}

\label{sec:astroquery}
% MHvK: feel free to move above label to where it makes most sense.

\secauthor{Adam Ginsburg}

Astroquery \cite{Ginsburg2019} is the astropy-coordinated package for interacting with online archives of astronomical and related data. It contains over 50 modules for querying astronomical databases, large and small. In particular, since \paperii, significant contributions to \texttt{astroquery} have come from several of the major archives, including the European Space Agency (ESA), the Mikulski Archive for Space Telescopes (MAST) at the Space Telescope Science Institute (STScI), the Infrared Science Archive at the NASA Infrared Processing and Analysis Center (IRSA at NASA IPAC), the Canadian Astronomical Data Center (CADC), and the Atacama Large Millimeter/Submillimeter Array archive (ALMA). These contributions represent a formal acknowledgement of the utility of a centralized tool suite for archive interaction.

The widespread usage of \texttt{astroquery} is apparent from the range of keywords represented in the journal articles which cite \cite{Ginsburg2019}; everything from astroids to galaxies is represented. Additionally Astroquery functionality has been built into several special purpose Python packages, such as \texttt{LightKurve} \cite{LightKurve} and SORA \cite{SORA}]. More than 4,000 repositories on GitHub make use of \texttt{astroquery} in some way, an \texttt{astroquery} features in a large number of tutorials on various facets of astronomical analysis.

Many of the existing and newly-contributed tools rely on Virtual Observatory (VO) tools.
These use the underlying package \texttt{pyvo}, which has also recently become an astropy-coordinated package. While many or all of the functions provided in \texttt{astroquery} can be achieved through direct use of VO tools implemented in \texttt{pyvo}, the \texttt{astroquery} interfaces more closely resemble the web interfaces more familiar to users.
% note to coauthors: we need a section on pyvo

\subsection{Connections with Observatories and Missions}

Brief summary of efforts in observatory- or mission-driven development that have
contributed to Astropy, and vice versa.

\subsubsection{James Webb Space Telescope}
\secauthor{Larry Bradley}

The James Webb Space Telescope (JWST) is a 6.5-meter space-based
infrared telescope that will provide unprecedented resolution and
sensitivity from 0.6 -- 28 microns. JWST will enable a broad range
of scientific investigations from exoplanets and their atmospheres
to the formation of galaxies in the very early universe. Its four
key scientific goals are to study the first light from stars and
galaxies, the assembly and evolution of galaxies, the birth of stars and
protoplanetary systems, and planetary systems and the origins of life.

The telescope launched on an Ariane 5 rocket on 2021 December 25 from
Kourou, French Guiana. After a series of successful deployments,
including the sunshield and primary and secondary mirrors, JWST reached
its orbit around the L2 Lagrange point on 2022 January 24. Commissioning
of the telescope optics and science instruments will occur from January
until the end of June 2022, when science operations are scheduled to
begin.

Software developers at the Space Telescope Science Institute (STScI),
the operations center of JWST, have been developing Python-based tools
for JWST since 2010 (starting with the JWST Calibration Reference Data
System) and have provided major contributions to \astropy from its
inception. The JWST instrument calibration pipelines, exposure-time
calculators, and data analysis tools are all written in Python and
depend on the \astropypkg core package and some coordinated and
affiliated packages. For the \astropypkg core package, the JWST mission
has provided extensive contributions to the \astropysubpkg{modeling},
\astropysubpkg{units}, \astropysubpkg{coordinates}, \astropysubpkg{wcs},
\astropysubpkg{io.fits}, \astropysubpkg{io.votable},
\astropysubpkg{stats}, \astropysubpkg{visualization}, and
\astropysubpkg{convolution} subpackages as well as to the general
package infrastructure and maintenance.

Likewise, JWST developers have provided significant contributions
to the \package{photutils} \citep{photutils}, \package{specutils}
\citep{specutils}, and \package{regions} \citep{regions} coordinated
packages and the \package{gwcs} \citep{gwcs} and \package{synphot}
\citep{synphot} affiliated packages. For example, development of the
\package{photutils} coordinated package for source detection and
photometry has largely been led by JWST contributions. JWST developers
have also made significant contributions to the \package{specutils}
coordinated package, which is used for analyzing spectroscopic data,
and the \package{regions} coordinated package, which is used to
handle geometric regions. The \package{gwcs} affiliated package for
generalized world coordinate systems was created specifically to handle
the complex world coordinate systems needed for JWST spectroscopic
data. The \package{synphot} affiliated package for synthetic photometry
was created at STScI and is a dependency of the JWST exposure-time
calculators. Further, the \package{ASDF} (Advanced Scientific Data
Format) package \citep{ASDF}, a next-generation interchange format for
scientific data, was initially developed at STScI to serialize JWST WCS
objects along with \astropypkg models, units, and coordinates. Over
its mission lifetime, JWST will continue its support in developing and
maintaining these critically dependent packages.


Gemini
\secunfilled

Cherenkov Telescope Array
\secauthor{Axel Donath, Maximilian Nöthe}

The Cherenkov Telescope (CTA) will be the next generation very-high-energy
gamma-ray observatory.
CTA will improve over the current generation of imaging atmospheric Cherenkov telescopes (IACTs)
by a factor of five to ten in sensitivity and will be able to observe the whole sky from a combination of two sites:
a northern site in La Palma, Spain, and a southern one in Paranal, Chile.
CTA will be able to observe gamma rays in a broad energy range from around $20\,\mathrm{GeV}$ to over $300\,\mathrm{TeV}$
using three different types of telescopes, in total over 100 telescopes are planned at the two sites.
CTA will also be the first open gamma-ray observatory.

The data analysis pipeline is developed as open source software and essentially split in two domains:
\begin{enumerate}
  \item In the low-level analysis, the properties of the recorded air-shower events
    have to be estimated from the raw data.
    The raw data consists of very short (\textasciitilde $40--100\,\mathrm{ns}$) videos recorded with the fast and
    sensitive cameras of the telescopes.
    This includes the energy, particle type and direction of origin of the particle that induced the air shower
    and the time the shower was recorded.
  \item In the higher-level analysis, these reconstructed event lists are used together with some
    characterization of the instrument response to perform the actual scientific analysis.
    This software will be delivered as CTA science tools to the future users of the Observatory.
\end{enumerate}

A prototype for the low-level analysis is \texttt{ctapipe} \citep{ctapipe},
a python package developed to perform all the necessary tasks to from the raw data
of Cherenkov telescopes to the reconstructed event lists.

The high-level analysis (or CTA science tools) will be based on the astropy affiliated package
Gammapy~\citep{gammapy}.

Both Gammapy and \texttt{ctapipe} are using astropy heavily, mainly for units, times, coordinate transformations,
tables and FITS IO.

As CTA will record gamma-ray events with a rate of up to $10\,000$ events per second,
it needs to perform a large number of coordinate transformations.
To enable this, CTA member M.~Nöthe contributed a major performance improvement
for large numbers of coordinates with different observation times,
based on earlier work by B.~Winkel.

Together with Gammapy maintainer A.~Donath and former maintainer C.~Deil,
a total of 107 merged pull requests were contributed to astropy.


Rubin Observatory
\secunfilled

LIGO/Virgo/KAGRA
\secauthor{Leo Singer}
\section{Future Plans for the Astropy Project} \label{sec:future}

\subsection{Roadmap}

\secauthor{Clara Brasseur}

Overview of roadmap and some highlights.

\section{Learn Astropy} \label{sec:learn}

\secauthor{Lía Corrales, David Shupe, Kelle Cruz + Learn team}

\subsubsection{Current status and scope}

\textit{Learn Astropy} is an umbrella term that acknowledges the broad
educational efforts made by the Astropy Project, which are led by the Learn
Team.
The efforts focus on developing online content and workshops covering
astronomy-specific coding tasks in Python.
As introduced in \citet{astropy:2018}, there are four different types of
Learn Astropy content: \textit{tutorials}, consisting of Jupyter Notebook
lessons that are published in HTML format online; \textit{guides}, which are a
series of lessons providing a foundational resource for performing certain
type of astronomical analyses; \textit{examples}, which are snippets of code
that showcase a short task that can be performed with Astropy or an affiliated
package; and \textit{documentation}, which is contained within the code base.
This categorization drives content development, infrastructure choices, and the
appearance of the Learn Astropy website.
The Learn Team meets weekly to work on creating, expanding, improving these
educational resources.

\begin{description}

\item[Learn Astropy website] The Learn Team re-launched the main website and
search interface for Learn Astropy in 2021 with a new infrastructure platform,
built around full-text search and interactive filtering functionality, with the
goal of making content discoverable as the Learn Astropy content catalog
expands.
This work has been supported in part by a grant from the Dunlap Institute.
We have adopted Algolia, a search-as-a-service cloud platform, to store the
full-text and metadata records of Learn Astropy's content.
The new Learn Astropy website is a JavaScript (Gatsby/React) application that
uses the Algolia service to power its search and filtering user interface.
Our Python-based application, Learn Astropy Librarian, populates data into the
Algolia service. We tuned the Librarian around specific content formats (such as
Jupyter Notebook-based tutorial pages and Jupyter Book-based guides) to more
accurately index content and heuristically extract metadata.
A consequence of the new platform is that we now maintain and compile content
separately from the website application itself, enabling new content types.
Tutorials, which are written as Jupyter Notebooks, are now compiled into their
own Learn Astropy sub-site using
\href{https://github.com/astropy/nbcollection}{\texttt{nbcollection}}.
Guides, which utilize the \href{https://jupyterbook.org/}{Jupyter Book} build
infrastructure, are also deployed as separate websites using GitHub pages.
This architecture opens future possibilities of indexing third-party content,
hosted elsewhere, such as on institutional websites.

\item[Tutorials] Currently, we have \# of tutorials, spanning a wide range of astronomical topics and common tasks.

\item[Guides] {\it ccdproc} Jupyter book has been completed.

\item[Workshops] The Project has been conducting workshops at winter
meetings of the American Astronomical Society since AAS 225 in January 2015.
Up to the start of the coronavirus pandemic, these were full-day in-person
workshops with as many as 90 participants and a dozen facilitators from the
project.
During the pandemic, these workshops were moved to an online format and split
into basic and advanced sessions.
Additionally, beginning with the AAS 238 online meeting, the workshops have been
expanded to Summer AAS meetings.
The Learn team finds that the workshop audience is best found as AAS meetings as
opposed to more general Python meetings.

The Astropy Project provided another mode of community engagement at AAS
Meetings 235 and 237 by organizing a NumFOCUS Sponsored Projects booth in the
AAS Exhibit Hall.
Funding for the exhibit hall was provided alternately by NumFOCUS and later by
the Moore Foundation funding (\textbf{check this}).
The booth hosted a series of Q\&A special sessions during AAS 235 and webinars
during the virtual AAS 237 meetings, to provide the general astronomy community
information and access to experts on a variety of open source astronomical
tools.
\end{description}

\subsubsection{Learn vision for the future}

The Learn plan going forward is to continue to improve the tutorial website and
facilate new content;
to index third-party tutorials; and to look for supportable opportunities to
expand the reach of Astropy workshops beyond the American Astronomical Society
meetings.



\subsection{Current and Future Challenges}

\section{Community Engagement}

\begin{itemize}
\item {\bf User forums:} The Astropy Project has historically maintained a number of avenues for users to seek help or gain access to the developer community. This includes the Astropy mailing list, the Python in Astronomy Facebook group, and the Astropy Slack workspace. The Moore Foundation grant allows this Slack space to
be on a paid plan; additionally NumFOCUS has negotiated a special rate for
open-source projects. While the Slack and Astropy-dev mailing lists are primarily used to discuss the project direction and updates, it was noted that the use of a Facebook community could present a barrier to open source. The Astropy Project identified a need for a public, archived, searchable, and easily-to-navigate interface for users to ask for help Accordingly, we have commissioned
a Discourse site which is more open than the Facebook group and more user-oriented
than Astropy Slack. A benefit of the Moore Foundation grant is that Astropy
developers are able to invoice as independent contractors the time they
spend helping users on these forums.
\end{itemize}

\begin{itemize}
\item Attracting new contributors when the code has become quite complex,
\item Contributor to maintainer mentoring,
\item Long-term / sustained funding for maintaining infrastructure,
\item ...
\end{itemize}


\begin{acknowledgments}

We would like to thank the members of the community that have contributed to
\astropy, that have opened issues and provided feedback, and have supported the
project in a number of different ways.

The \astropy community is supported by and makes use
of a number of organizations and services outside the traditional
academic community. We thank Google for financing and organizing the
Google Summer of Code (GSoC) program, that has funded severals
students per year to work on \astropy related projects over the
summer. These students often turn into long-term contributors. We also
thank NumFOCUS and the Python Software Foundation for financial
support. Within the academic community, we thank
institutions that make it possible that astronomers and other developers on
their staff can contribute their time to the development of
\astropy projects.  We would like acknowledge the support of the
Space Telescope Science Institute, Harvard--Smithsonian Center for Astrophysics,
and the South African Astronomical Observatory.

Furthermore, the \astropy packages would not exist in their current form without
a number of web services for code hosting, continuous integration, and
documentation; in particular, \astropy heavily relies on GitHub, Travis CI,
Appveyor, CircleCI, and Read the Docs.

\astropypkg interfaces with the SIMBAD database, operated at CDS, Strasbourg,
France. It also makes use of the ERFA library \citep{erfa}, which in turn
derives from the IAU SOFA Collection\footnote{\url{http://www.iausofa.org}}
developed by the International Astronomical Union Standards of Fundamental
Astronomy \citep{sofa}.

\end{acknowledgments}

\software{\package{astropy} \citep{astropy:2013, astropy:2018},
          \package{numpy} \citep{numpy:nature},
          \package{scipy} \citep{scipy},
          \package{matplotlib} \citep{matplotlib},
          \package{Cython} \citep{cython},
          \package{photutils} \citep{photutils},
          \package{specutils} \citep{specutils},
          \package{regions} \citep{regions},
          \package{gwcs} \citep{gwcs},
          \package{synphot} \citep{synphot},
          \package{ASDF} \citep{ASDF}.
        %   \package{SOFA} \citep{sofa},
        %   \package{ERFA} (\citealt{erfa})
          }

\bibliographystyle{aasjournal}
\bibliography{refs}

% \appendix

% \section{List of Affiliated Packages}

% \begin{longrotatetable}
%     \begin{deluxetable*}{cccp{3in}c}
%     \tablecaption{Registry of affiliated packages.}
%     \label{tab:registry}
%     \tablehead{
%         \colhead{Package Name} &
%         \colhead{Stable} &
%         \colhead{PyPI Name} &
%         \colhead{Maintainer} &
%         \colhead{Citation}
%       }
%       \startdata
%         \input{registry.tex}
%       \enddata
%   \end{deluxetable*}
% \end{longrotatetable}


\end{document}
